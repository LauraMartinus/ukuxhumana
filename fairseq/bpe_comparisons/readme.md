This needs to be cleaned up